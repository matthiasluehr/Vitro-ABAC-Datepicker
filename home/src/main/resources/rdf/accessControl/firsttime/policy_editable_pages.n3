# $This file is distributed under the terms of the license in LICENSE$
@prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
@prefix owl: <http://www.w3.org/2002/07/owl#> .
@prefix rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#> .
@prefix xsd: <http://www.w3.org/2001/XMLSchema#> .
@prefix auth: <http://vitro.mannlib.cornell.edu/ns/vitro/authorization#> .
@prefix ai: <https://vivoweb.org/ontology/vitro-application/auth/individual/> .
@prefix ao: <https://vivoweb.org/ontology/vitro-application/auth/vocabulary/> .
@prefix : <https://vivoweb.org/ontology/vitro-application/auth/individual/policy/edit-individual-pages/> .

:Policy rdf:type ao:Policy ;
    ao:rules :RuleSet .

:RuleSet rdf:type ao:Rules ;
    ao:rule :AllowEditRelatedPagesRule ;
    ao:rule :AllowEditIndividualPagesRule .

:AllowEditIndividualPagesRule rdf:type ao:Rule;
    ao:check :SubjectRoleOneOfEditorsCheck ;
    ao:check :IsAddOperation ;
    ao:check :IsObjectPropertyStatement ;
    ao:check :ObjectUriIsSomeUri ;
    ao:check :PredicateIsSomePredicate .

:SubjectRoleOneOfEditorsCheck rdf:type ao:Check ;
    ao:operator ai:OneOf ;
    ao:attribute ai:SubjectRole ;
    ao:value auth:ADMIN ;
    ao:value auth:CURATOR ;
    ao:value auth:EDITOR .

:SubjectRoleIsSelfEditor rdf:type ao:Check ;
    ao:operator ai:Equals ;
    ao:attribute ai:SubjectRole ;
    ao:value auth:SELF_EDITOR .

:IsAddOperation rdf:type ao:Check ;
    ao:operator ai:Equals ;
    ao:attribute ai:Operation ;
    ao:value ai:AddOperation .

:AllowEditRelatedPagesRule rdf:type ao:Rule;
    ao:check :SubjectRoleIsSelfEditor ;
    ao:check :SubjectUriIsProfileRelatedResource ;
    ao:check :IsAddOperation ;
    ao:check :IsObjectPropertyStatement ;
    ao:check :ObjectUriIsSomeUri ;
    ao:check :PredicateIsSomePredicate .

:PredicateIsSomePredicate rdf:type ao:Check ;
    ao:operator ai:Equals ;
    ao:attribute ai:StatementPredicateUri ;
    ao:value ai:SomeUriTestData .

:ObjectUriIsSomeUri rdf:type ao:Check ;
    ao:operator ai:Equals ;
    ao:attribute ai:StatementObjectUri ;
    ao:value ai:SomeUriTestData .

:SubjectUriIsProfileRelatedResource rdf:type ao:Check ;
    ao:operator ai:SparqlSelectQueryContains ;
    ao:attribute ai:StatementSubjectUri ;
    ao:value ai:PersonProfileProximityToResourceUri .

:IsObjectPropertyStatement rdf:type ao:Check ;
    ao:operator ai:Equals ;
    ao:attribute ai:AccessObjectType ;
    ao:value ai:ObjectPropertyStatementAccesObject .

